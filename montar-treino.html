<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Montar Treino</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0a0a14; color: white; margin: 0; display: flex; height: 100vh; }
        
        .sidebar { width: 300px; background: rgba(255,255,255,0.05); border-right: 1px solid rgba(255,255,255,0.1); padding: 20px; overflow-y: auto; }
        .ex-item { background: rgba(255,255,255,0.1); padding: 10px; margin-bottom: 10px; border-radius: 8px; cursor: pointer; transition: 0.3s; border: 1px solid transparent; }
        .ex-item:hover { border-color: #ff4fa3; background: rgba(255,79,163,0.1); }

        .main { flex: 1; padding: 30px; overflow-y: auto; }
        .header { background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.1); }
        
        input, textarea, select { width: 100%; padding: 12px; margin: 10px 0; background: #1a1a2e; border: 1px solid rgba(255,255,255,0.2); color: white; border-radius: 8px; }
        
        .grid-dias { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .dia-card { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px; border-top: 3px solid #ff4fa3; min-height: 150px; }
        .dia-card h4 { margin-top: 0; color: #ff4fa3; text-transform: capitalize; }
        
        .ex-selecionado { background: #ff4fa3; color: white; padding: 5px 10px; border-radius: 4px; margin-bottom: 5px; font-size: 12px; display: flex; justify-content: space-between; }
        .remove-btn { cursor: pointer; font-weight: bold; }

        .btn-salvar { background: #ff4fa3; color: white; border: none; padding: 15px 40px; border-radius: 30px; font-weight: bold; cursor: pointer; float: right; margin-top: 20px; font-size: 16px; transition: 0.3s; }
        .btn-salvar:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(255,79,163,0.4); }
    </style>
</head>
<body>

<div class="sidebar">
    <h3>üí™ Exerc√≠cios</h3>
    <p><small>Selecione o dia no painel e clique no exerc√≠cio para adicionar:</small></p>
    
    <div class="ex-item" onclick="adicionarEx('Supino Reto')">
        <span>Supino Reto</span>
    </div>
    <div class="ex-item" onclick="adicionarEx('Abdominais')">
        <span>Abdominais</span>
    </div>
</div>

<div class="main">
    <div class="header">
        <h2>‚öôÔ∏è Montar Treino Personalizado</h2>
        <input type="email" id="alunoEmail" placeholder="E-mail do aluno">
        <select id="diaAtual">
            <option value="segunda">Segunda-feira</option>
            <option value="terca">Ter√ßa-feira</option>
            <option value="quarta">Quarta-feira</option>
            <option value="quinta">Quinta-feira</option>
            <option value="sexta">Sexta-feira</option>
        </select>
        <textarea id="obsGeral" rows="3" placeholder="Observa√ß√µes e dicas..."></textarea>
    </div>

    <div class="grid-dias">
        <div class="dia-card"><h4>Segunda</h4><div id="lista-segunda"></div></div>
        <div class="dia-card"><h4>Ter√ßa</h4><div id="lista-terca"></div></div>
        <div class="dia-card"><h4>Quarta</h4><div id="lista-quarta"></div></div>
        <div class="dia-card"><h4>Quinta</h4><div id="lista-quinta"></div></div>
        <div class="dia-card"><h4>Sexta</h4><div id="lista-sexta"></div></div>
    </div>

    <!-- √ÅREA DO PDF -->
    <div id="treinoPDF" style="background:white;color:black;padding:30px;width:800px;position:absolute;left:-9999px;">
        <h1 style="text-align:center;color:#ff4fa3;">FICHA DE TREINO</h1>
        <hr>
        <p id="pdfEmail"></p>
        <p id="pdfObs"></p>
        <div id="pdfConteudo"></div>
        <hr>
        <p style="font-size:12px;text-align:center;">Jessica Personal Trainer</p>
    </div>

    <button class="btn-salvar" id="btnSalvar">üöÄ Gerar PDF do Treino</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
let treinoData = { segunda: [], terca: [], quarta: [], quinta: [], sexta: [] };

function adicionarEx(nome) {
    const dia = document.getElementById('diaAtual').value;
    treinoData[dia].push({ nome });
    renderizar();
}

function removerEx(dia, index) {
    treinoData[dia].splice(index, 1);
    renderizar();
}

function renderizar() {
    const dias = ['segunda', 'terca', 'quarta', 'quinta', 'sexta'];
    dias.forEach(dia => {
        const container = document.getElementById(`lista-${dia}`);
        container.innerHTML = treinoData[dia].map((ex, i) => `
            <div class="ex-selecionado">
                ${ex.nome} <span class="remove-btn" onclick="removerEx('${dia}', ${i})">‚úï</span>
            </div>
        `).join('');
    });
}

function gerarHTMLTreino(email, obs, dados) {
    const nomesDias = {
        segunda: "Segunda-feira",
        terca: "Ter√ßa-feira",
        quarta: "Quarta-feira",
        quinta: "Quinta-feira",
        sexta: "Sexta-feira"
    };

    let html = "";

    for (let dia in dados) {
        if (dados[dia].length > 0) {
            html += `<h3 style="color:#ff4fa3;margin-top:20px;">${nomesDias[dia]}</h3>`;
            html += `<table style="width:100%;border-collapse:collapse;">`;
            html += `<tr>
                        <th style="border:1px solid #000;padding:6px;">#</th>
                        <th style="border:1px solid #000;padding:6px;">Exerc√≠cio</th>
                     </tr>`;

            dados[dia].forEach((ex, index) => {
                html += `
                    <tr>
                        <td style="border:1px solid #000;padding:6px;">${index + 1}</td>
                        <td style="border:1px solid #000;padding:6px;">${ex.nome}</td>
                    </tr>
                `;
            });

            html += `</table>`;
        }
    }

    document.getElementById("pdfEmail").innerHTML = `<strong>Aluno:</strong> ${email}`;
    document.getElementById("pdfObs").innerHTML = `<strong>Observa√ß√µes:</strong> ${obs || "Nenhuma observa√ß√£o."}`;
    document.getElementById("pdfConteudo").innerHTML = html;
}

document.getElementById('btnSalvar').onclick = async () => {
    const email = document.getElementById('alunoEmail').value.toLowerCase().trim();
    const obs = document.getElementById('obsGeral').value;

    if (!email) return alert("Digite o e-mail do aluno!");

    gerarHTMLTreino(email, obs, treinoData);

    await new Promise(resolve => setTimeout(resolve, 300));

    const elemento = document.getElementById("treinoPDF");
    const nomeArquivo = email.replace(/[@.]/g, "_") + "_treino.pdf";

    const opt = {
        margin: 10,
        filename: nomeArquivo,
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    };

    html2pdf().set(opt).from(elemento).save();

    alert("‚úÖ PDF gerado com sucesso!");
};
</script>
</body>
</html>
